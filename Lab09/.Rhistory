PDB <- read.csv("PDB_DATA.csv")
PDB <- read.csv("PDB_DATA.csv", check.names = FALSE, stringsAsFactors = FALSE)
PDB <- read.csv("PDB_DATA.csv", check.names = FALSE, stringsAsFactors = FALSE)
# tidy helpers ----
library(dplyr)
library(rlang)
# Guess the likely column names in the CSV
method_col <- grep("method|exp", names(PDB), ignore.case = TRUE, value = TRUE)[1]
type_col   <- grep("molecular|mol.*type|type", names(PDB), ignore.case = TRUE, value = TRUE)[1]
count_col  <- grep("count|entries|structures|total", names(PDB), ignore.case = TRUE, value = TRUE)[1]
stopifnot(!is.na(method_col), !is.na(type_col), !is.na(count_col))
total_n <- sum(PDB[[count_col]], na.rm = TRUE)
install.packages(dplyr)
PDB <- read.csv("PDB_DATA.csv", check.names = FALSE, stringsAsFactors = FALSE)
library(dplyr)
library(rlang)
# --- Find likely columns ---
method_col <- grep("method|exp", names(PDB), ignore.case = TRUE, value = TRUE)[1]
type_col   <- grep("molecular|mol.*type|type", names(PDB), ignore.case = TRUE, value = TRUE)[1]
count_col  <- grep("count|entries|structures|total", names(PDB), ignore.case = TRUE, value = TRUE)[1]
cat("Guessed columns -> method:", method_col, "| type:", type_col, "| count:", count_col, "\n")
stopifnot(!is.na(method_col), !is.na(type_col), !is.na(count_col))
# --- Clean the count column to numeric (removes commas/percent signs/etc.) ---
PDB <- PDB %>%
mutate(.count = suppressWarnings(as.numeric(gsub("[^0-9.]", "", .data[[count_col]]))))
total_n <- sum(PDB$.count, na.rm = TRUE)
q1_pct <- PDB %>%
filter(
grepl("x.?ray", .data[[method_col]], ignore.case = TRUE) |
grepl("electron microscopy|cryo[- ]?em|(^|[[:space:]])em($|[[:space:]])",
.data[[method_col]], ignore.case = TRUE)
) %>%
summarise(pct = 100 * sum(.count, na.rm = TRUE) / total_n) %>%
pull(pct)
q1_pct
q2_prop <- PDB %>%
filter(grepl("protein", .data[[type_col]], ignore.case = TRUE)) %>%
summarise(prop = sum(.count, na.rm = TRUE) / total_n) %>%
pull(prop)
q2_prop            # fraction (0â€“1); multiply by 100 for %
stats <- read.csv("PDB_DATA.csv")
stats
stats <- read.csv("Data Export Summary.csv")
stats
stats$Total
sum(stats$Neutron)
as.numeric(sub(",", "", stats$Total))
library(readr)
download.file(readr)
download.file("readr")
install.packages("readr")
library(readr)
read_csv("Data Export Summary.csv")
stats$Total
as.numeric(sub(",", "", stats$Total))
#substitute "" to ","
stats$Total
sum(stats$Total)
library(readr)
stats <- read_csv("Data Export Summary.csv")
stats
sum(stats$Total)
n.total <- sum(stats$Total)
n.total
library(dpryl)
install.packages(dpryl)
> install.packages("dpryl")
install.packages("dpryl")
n.xray <- sum(stats$`X-ray`)
n.xray / n.total
n.xray <- sum(stats$`X-ray`)
n.xray / n.total * 100
n.xray <- sum(stats$`X-ray`)
p.xray <- n.xray / n.total * 100
n.xray <- sum(stats$`X-ray`)
p.xray <- n.xray / n.total * 100
round(p.xray, 2)
n.EM <- sum(stats$`EM`)
p.EM <- n.EM / n.total * 100
round(p.EM, 2)
n.xray <- sum(stats$`X-ray`)
percent.xray <- n.xray / n.total * 100
percent.xray
round(percent.xray, 2)
library(readr)
stats <- read_csv("Data Export Summary.csv")
stats
library(readr)
stats <- read_csv("Data Export Summary.csv")
stats
library(readr)
stats <- read_csv("Data Export Summary.csv")
stats
library(readr)
stats <- read_csv("Data Export Summary.csv")
stats
library(readr)
stats <- read_csv("Data Export Summary.csv")
stats
proportion_protein <- mean(stats = "Protein")
proportion_protein <- mean(stats == "Protein")
print(proportion_protein)
proportion_protein <- mean(stats == "Protein (only)")
print(proportion_protein)
View(stats)
stats$Total
View(stats)
n.protein <- sum(stats$`Protein (only)`)
p.protein <- n.protein / n.total * 100
round(p.protein, 2)
n.protein <- sum(stats$Protein (only))
n.protein_only <- stats$Total[tats == "Protein (only)"]
n.protein_only <- stats$Total[stats == "Protein (only)"]
proportion.protein_only <- n.protein_only / n.total * 100
round(proportion.protein_only, 2)
n.protein_only <- stats$Total[stats == "Protein (only)"]
proportion.protein_only <- n.protein_only / n.total
round(proportion.protein_only, 2)
round(stats$Total[1]/n.total *100, 2)
library(bio3d)
library(bio3d)
hiv <- read.pdb("1hsg")
hiv
head(hiv$atom)
pdbseq(hiv)
trim.pdb(hiv, chain="A")
chainA_seq <- pdbseq(trim.pdb(hiv, chain="A"))
install.packages("pak")
library(bio3dview)
install.packages("bio3dview")
install.packages("NGLVieweR")
pak::pak("bioboot/bio3dview")
library(bio3dview)
view.pdb(hiv)
view.pdb(hiv, coclorScheme="chain")
view.pdb(hiv, coclorScheme = "chain")
library(bio3dview)
library(NGLVieweR)
view.pdb(hiv, coclorScheme = "chain")
view.pdb(hiv, colorScheme = "chain",
col=c("blue","orange"),
backgroundColor = "pink")
sel <- atom.select(hiv, resno=25)
view.pdb(hiv, highlight = sel,
highlight.style = "spacefill",
colorScheme = "chain",
col=c("blue","orange"),
backgroundColor = "pink")
adk <- read.pdb("6s36")
adk
m <- nma(adk)
pdb(m)
m <- nma(adk)
plot(m)
mktrj(m, file="ADK_nma.pdb")
mktrj(m, file="ADK_nma.pdb")
view.nma(m)
R.version
