counts <- read.csv("GSE37704_featurecounts.csv", row.names = 1)
counts <- read.csv("GSE37704_featurecounts.csv", row.names = 1)
metadata <- read.csv("GSE37704_metadata.csv")
head(counts)
metadata
ncol(counts)
nrow(metadata)
cleancounts <- counts[,-1]
colnames(cleancounts)
metadata$id
all(colnames(cleancounts) == metadata$id)
head(cleancounts)
to.keep.inds <- rowSums(cleancounts) > 0
nonzero_counts <- cleancounts[to.keep.inds,]
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData = nonzero_counts,
colData = metadata,
design = ~condition)
dds <- DESeq(dds)
res <- results(dds)
summary(res)
library(ggplot2)
ggplot(res) +
aes(log2FoldChange, -log(padj)) +
geom_point()
# Make a color vector for all genes
mycols <- rep("gray", nrow(res) )
# Color red the genes with absolute fold change above 2
mycols[ abs(res$log2FoldChange) > 2 ] <- "red"
# Color blue those with adjusted p-value less than 0.01
# and absolute fold change more than 2
inds <- (res$padj < 0.01) & (abs(res$log2FoldChange) > 2)
mycols[ inds ] <- "blue"
plot( res$log2FoldChange, -log(res$padj),
col = mycols,
xlab = "Log2(FoldChange)", ylab = "-Log(P-value)" )
mycols <- rep("gray", nrow(res))
mycols[abs(res$log2FoldChange) > 2 & res$padj < 0.05] <- "blue"
ggplot(res) +
aes(log2FoldChange, -log(padj), color = mycols) +
geom_point() +
geom_vline(xintercept = c(-2, 2), color = "red") +
geom_hline(yintercept = -log(0.05), color = "red") +
scale_color_identity()
library(AnnotationDbi)
counts <- read.csv("GSE37704_featurecounts.csv", row.names = 1)
metadata <- read.csv("GSE37704_metadata.csv")
library(AnnotationDbi)
install.packages("AnnotationDbi")
library(AnnotationDbi)
install.packages("AnnotationDbi")
## Focus on top 5 downregulated pathways
keggrespathways_down <- rownames(keggres$less)[1:5]
if (!requireNamespace("BiocManager", quietly = TRUE)) {
install.packages("BiocManager")
}
BiocManager::install("AnnotationDbi")
install.packages("org.Hs.eg.db")
if (!requireNamespace("BiocManager", quietly = TRUE)) {
install.packages("BiocManager")
}
BiocManager::install("org.Hs.eg.db")
install.packages("gage")
if (!requireNamespace("BiocManager", quietly = TRUE)) {
install.packages("BiocManager")
}
BiocManager::install("gage")
if (!requireNamespace("BiocManager", quietly = TRUE)) {
install.packages("BiocManager")
}BiocManager::install("org.Hs.eg.db")
if (!requireNamespace("BiocManager", quietly = TRUE)) {
install.packages("BiocManager")
} BiocManager::install("gageData")
if (!requireNamespace("BiocManager", quietly = TRUE)) {
install.packages("BiocManager")
}
BiocManager::install("gageData")
if (!requireNamespace("BiocManager", quietly = TRUE)) {
install.packages("BiocManager")
}
BiocManager::install("pathview")
