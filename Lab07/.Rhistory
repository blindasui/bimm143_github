hist(rnorm(500))
hist(rnorm(500, mean=5))
rnorm(30)
rnorm(30, mean=-3)
rnorm(30, mean=-3) #so every number is around -3
rnomr(30, mean=3)
rnorm(30, mean=-3) #so every number is around -3
rnorm(30, mean=3)
c(rnorm(30, mean=-3),rnorm(30, mean=3)) #so every number is around -3 or 3
x <- c(rnorm(30, mean=-3),rnorm(30, mean=3))
y <- rev(x)
x <- c(rnorm(30, mean=-3),rnorm(30, mean=3))
y <- rev(x)
y
cbind(x, y)
cbind(x, y)
plot(x)
kmeans(x, centers = 2)
k <- kmeans(x, centers = 2)
k
k$size
k$cluster
k$centers
plot(x)
plot(x, col = "red")
plot(x, col = "pink")
plot(x, col = "blue")
plot(x, col = c("red", "blue")
plot(x, col = c("red", "blue"))
plot(x, col = 4)
plot(x, col = 7)
plot(x, col = 100)
plot(x, col = 777)
plot(x, col = 5)
plot(x, col = 6)
plot(x, col = 7)
plot(x, col = k$cluster, pch=16)
x <- c(rnorm(30, mean=-3),rnorm(30, mean=3))
y <- rev(x) #reverse x
cbind(x, y)
plot(x)
plot(x, col = k$cluster, pch=16)
plot(x, col = k$cluster, pch=16)
points(k$centers, col="blue")
plot(x, col = k$cluster, pch=16)
points(k$centers, col="blue", pch=15, cex=2)
kmeans(x, centers = 4)
k4 <- kmeans(x, centers = 4)
plot(x, col=k4$cluster)
points(kr$centers, pch=15)
k4 <- kmeans(x, centers = 4)
plot(x, col=k4$cluster)
points(k4$centers, pch=15)
k2 <- kmeans(x, centers = 2)
k3 <- kemans(x, centers = 3)
k2 <- kmeans(x, centers = 2)
k3 <- kmeans(x, centers = 3)
k4 <- kmeans(x, centers = 4)
k1 <- kmeans(x, centers = 1)
k2 <- kmeans(x, centers = 2)
k3 <- kmeans(x, centers = 3)
k4 <- kmeans(x, centers = 4)
k5 <- kmeans(x, centers = 5)
z <- c(k1$tot.withinss,
k2$tot.withinss,
k3$tot.withinss,
k4$tot.withinss,
k5$tot.withinss)
plot(z, typ = "b")
n <- NULL
for(i in 1:5) {
n <- c(n, kmeans(x, centers = i)$tot.withinss)
}
plot(n, typ = "b")
dist(x)
#hclust()
d <- dist(x)
hc <- hclust(d)
hc
plot(hc)
plot(hc)
abline(h=8, col="red")
hist(rnorm(500, mean=5))
x <- c(rnorm(30, mean=-3),rnorm(30, mean=3))
y <- rev(x) #reverse x
cbind(x, y)
plot(x)
kmeans(x, centers = 2)
k <- kmeans(x, centers = 2)
k
k$size
k$cluster
k$centers
plot(x, col = c("red", "blue"))
plot(x, col = 7)
plot(x, col = k$cluster, pch=16)
points(k$centers, col="blue", pch=15, cex=2)
k4 <- kmeans(x, centers = 4)
plot(x, col=k4$cluster)
points(k4$centers, pch=15)
k1 <- kmeans(x, centers = 1)
k2 <- kmeans(x, centers = 2)
k3 <- kmeans(x, centers = 3)
k4 <- kmeans(x, centers = 4)
k5 <- kmeans(x, centers = 5)
z <- c(k1$tot.withinss,
k2$tot.withinss,
k3$tot.withinss,
k4$tot.withinss,
k5$tot.withinss)
plot(z, typ = "b")
n <- NULL
for(i in 1:5) {
n <- c(n, kmeans(x, centers = i)$tot.withinss)
}
plot(n, typ = "b")
d <- dist(x)
hc <- hclust(d)
hc
plot(hc)
abline(h=8, col="red")
cutree(hc, h=8)
plot(hc)
abline(h=8, col="red")
cutree(hc, h=8)
grps <- cutree(hc, k=2)
plot(x, col=grps)
url <- "https://tinyurl.com/UK-foods"
x <- read.csv(rul)
url <- "https://tinyurl.com/UK-foods"
x <- read.csv(url)
head(x)
rownames(x) <- x[,1]
rownames(x) <- x[,1]
x
rownames(x) <- x[, 1]
x[, -1]
x
rownames(x) <- x[, 1]
x[, -1]
x
rownames(x) <- x[, 1]
x <- x[, -1]
x
x <- read.csv(url, row.names = 1)
x
barplot(as.matrix(x), beside=T, col=rainbown(nrow(x)))
barplot(as.matrix(x), beside=T, col=rainbow(nrow(x)))
pairs(x, col=rainbow(nrow(x), pch=16)
pairs(x, col=rainbow(nrow(x)), pch=16)
barplot(as.matrix(x), beside=F, col=rainbow(nrow(x)))
t(x)
prcomp(t(x))
prcomp(t(x))
pca
pca <- prcomp(t(x))
summary(pca)
pca$x
pca$x
plot(pca$x[,1], pca$x[,2])
cols <- c("orange", "red", "blue", "darkgreen")
plot(pca$x[,1], pca$x[,2], col=cols, pch=16)
ggplot(pca$x) +
aes(PC1, PC2) +
geom_point()
library(ggplot2)
ggplot(pca$x) +
aes(PC1, PC2) +
geom_point()
ggplot(pca$x) +
aes(PC1, PC2) +
geom_point(col=cols)
ggplot(pca$rotation) +
aes(PC1, rownames(pca$rotation)) +
geom_col()
library(ggplot2)
ggplot(pca$x) +
aes(PC1, PC2) +
geom_point(col=cols)
ggplot(pca$rotation) +
aes(PC1, rownames(pca$rotation)) +
geom_col()
