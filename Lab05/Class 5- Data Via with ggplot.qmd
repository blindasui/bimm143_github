---
title: "Class 5: Data Viz with ggplot"
author: "Blinda (PID: A17117043)"
format: gfm
---

Today we are exploring the **gggplot** package and how to make nice figures in R.

There are lots of ways to make figures and plot in R. These include:

- so called "base"R
- and add on packages like **ggplot2**

Here is a simple "base" R plot

```{r}
head(cars)
```

We can simply pass this to the 'plot()' function

```{r}
plot(cars)
```

> Key-point: Base R is quick but not so nice looking in some folks eyes.

let's see how we can plot this with **ggplot2**

1st I need to install this add-on package. For this we use the 'install.packages()' function - **WE DO THIS IN THE CONSOLE, NOT our report**

2nd We need to load the package with the 'library()' function every time we want to use it.

```{r}
library(ggplot2)
ggplot(cars)
```


Every ggplot is complosed of at least 3 laryers:

- **data** (i.e. a data.frame with the things you wnat to plot)
- aesthetics **aes()** that map the columns of data to your plot features (i.e. aesthetics)
- geoms like **gemo_plot()** that sort hwo the plot appears

```{r}
ggplot(cars) + 
  aes(x=speed, y=dist) + 
  geom_point()
```

```{r}
hist(cars$speed)
```

> Key point: For simple "canned" graphs base R is quicker and more concise but as things get more custom the elobrate then ggplot wins out...

Let's add more layers to our ggplot

Add a line showing the relationship between x and y
Add a title
Add custom axis labels "Speed (MPH)" and "Distance (ft)"
Change the theme...

```{r}
ggplot(cars) +
  aes(x=speed, y=dist) +
  geom_point() +
  geom_smooth(method="lm",se=FALSE) +
  labs(title="Silly plot of Speed vs Stoping distance",
       x="speed (MPH)",
       y="distance (ft)" ) +
  theme_bw()
```

##Going further

Read some gene expression data

```{r}
url <- "https://bioboot.github.io/bimm143_S20/class-material/up_down_expression.txt"
genes <- read.delim(url)

head(genes)
```

> Q1. How many gnees are in this wee dataset

```{r}
nrow(genes)
```

```{r}
ncol(genes)
```

> Q2. How many "up" regulated genes are there?

```{r}
sum(genes$State == "up")
```

A useful function for counting up occurances of things in a vector is the 'table()' function

```{r}
table(genes$State)
```

fraction

```{r}
round( table(genes$State)/nrow(genes) * 100, 2 )
```

Make a v1 figure

```{r}
p <-ggplot(genes) +
  aes(x=Condition1, 
      y=Condition2, 
      col=State) +
  geom_point()

p
```

```{r}
p + scale_colour_manual(values=c("yellow","pink","purple")) +
    labs(title="Gene Expresion Changes Upon Drug Treatment",
         x="Control (no drug) ",
         y="Drug Treatment")
```

## More Plotting

Read gapmider

```{r}
# File location online
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"

gapminder <- read.delim(url)
```

Lets have a wee peak

```{r}
head(gapminder,3)
```


> Q4. How many different country values are in this dataset?

```{r}
nrow(gapminder)
```

```{r}
table(gapminder$country)
```

```{r}
length(table(gapminder$country))
```

>Q5.How many different continent values are in this dataset.

```{r}
unique(gapminder$continent)
```

```{r}
ggplot(gapminder) +
  aes(gdpPercap, lifeExp, col=continent, label=country) +
  geom_point() +
  geom_text()
```

I can use **ggrepl** package to make more sensible labels here.

```{r}
library(ggrepel)

ggplot(gapminder) +
  aes(gdpPercap, lifeExp, col=continent, label=country) +
  geom_point() +
  geom_text_repel()
```
I want a seperate a pnnel per continent
```{r}
ggplot(gapminder) +
  aes(gdpPercap, lifeExp, col=continent, label=country) +
  geom_point() +
  facet_wrap(~continent)
```

##Summary

The main advantages of ggplot over base R plotting are:

Letâ€™s focus on the main advantages of ggplot2 over base R plotting:

1. ggplot2 uses a layered approach (data, aesthetics, geometry), making it easier to build complex, publication-quality plots by adding layers step by step. Base R requires different functions and many arguments for each plot type, which can be fiddly and time-consuming to refine for publication-quality figures.

2. ggplot2 provides sensible defaults for aesthetics and themes, so plots look visually appealing with less manual tweaking. Base R gives full control but often needs more effort to polish. 

3. ggplot2 code is more concise for complex plots, while base R is quicker for simple, exploratory plots but gets verbose and complicated for advanced visualizations. 

4. ggplot2 makes it easier to automate and reproduce plots, especially for reports, since the same code structure applies to different datasets and plot types.